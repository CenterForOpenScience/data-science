/* categorizing nodes by products [preprint supp nodes, osf4m, node, registration, 
public with files, public without files, private with files, private without files] - doesn't include links, excludes empty projects created by NPD*/


WITH existing_files AS (SELECT COUNT(*) AS num_files, target_object_id, MIN(created) AS first_osf_file_created, MAX(created) AS last_osf_file_created
						FROM osf_basefilenode
						WHERE type NOT LIKE '%folder%' AND 
							  provider LIKE 'osfstorage' AND 
							  osf_basefilenode.deleted_on IS NULL AND 
							  osf_basefilenode.target_content_type_id = 30
						GROUP BY target_object_id),
	addon_connections AS (SELECT osf_abstractnode.id,
								LEAST(bitbucket.created, box.created, dataverse.created, dropbox.created, figshare.created, github.created, gitlab.created, googledrive.created, onedrive.created, owncloud.created, s3.created) AS first_addon_added,
								GREATEST(bitbucket.created, box.created, dataverse.created, dropbox.created, figshare.created, github.created, gitlab.created, googledrive.created, onedrive.created, owncloud.created, s3.created) AS last_addon_added,
								(SELECT count(*) from (values (bitbucket.created), (box.created), (dataverse.created), (dropbox.created), (figshare.created), (github.created), (gitlab.created), (googledrive.created), (onedrive.created), (owncloud.created), (s3.created)) as v(col) WHERE v.col is not null) AS num_addons,
								bitbucket.created AS bitbucket_added,
								box.created AS box_added,
								dataverse.created AS dataverse_added,
								dropbox.created AS dropbox_added,
								figshare.created AS figshare_added,
								github.created AS github_added,
								gitlab.created AS gitlab_added,
								googledrive.created AS googledrive_added,
								onedrive.created AS onedrive_added,
								owncloud.created AS owncloud_added,
								s3.created AS s3_added
							FROM osf_abstractnode
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_bitbucket_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_bitbucket_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  repo IS NOT NULL AND
												  action = 'bitbucket_repo_linked'
											GROUP BY node_id) bitbucket
							ON osf_abstractnode.id = bitbucket.node_id	
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_box_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_box_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  folder_name IS NOT NULL AND
												  action = 'box_folder_selected'
											GROUP BY node_id) box
							ON osf_abstractnode.id = box.node_id
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_dataverse_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_dataverse_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  dataset IS NOT NULL AND
												  action = 'dataverse_dataset_linked'
											GROUP BY node_id) dataverse
							ON osf_abstractnode.id = dataverse.node_id
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_dropbox_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_dropbox_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  folder IS NOT NULL AND
												  action = 'dropbox_folder_selected'
											GROUP BY node_id) dropbox
							ON osf_abstractnode.id = dropbox.node_id
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_figshare_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_figshare_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  folder_name IS NOT NULL AND
												  action = 'figshare_folder_selected'
											GROUP BY node_id) figshare
							ON osf_abstractnode.id = figshare.node_id
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_github_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_github_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  repo IS NOT NULL AND 
												  action = 'github_repo_linked'
											GROUP BY node_id) github
							ON osf_abstractnode.id = github.node_id
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_gitlab_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_gitlab_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
											      repo IS NOT NULL AND
											      action = 'gitlab_repo_linked'
											GROUP BY node_id) gitlab
							ON osf_abstractnode.id = gitlab.node_id
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_googledrive_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_googledrive_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  folder_path IS NOT NULL AND
												  action = 'googledrive_folder_selected'
											GROUP BY node_id) googledrive
							ON osf_abstractnode.id = googledrive.node_id
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_onedrive_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_onedrive_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  folder_path IS NOT NULL AND
												  action = 'onedrive_folder_selected'
											GROUP BY node_id) onedrive
							ON osf_abstractnode.id = onedrive.node_id
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_owncloud_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_owncloud_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  folder_id IS NOT NULL AND
												  action = 'owncloud_folder_selected'
											GROUP BY node_id) owncloud
							ON osf_abstractnode.id = owncloud.node_id
							LEFT JOIN (SELECT node_id, MAX(date) AS created
											FROM addons_s3_nodesettings
											LEFT JOIN osf_nodelog
											ON addons_s3_nodesettings.owner_id = osf_nodelog.node_id
											WHERE deleted IS FALSE AND 
												  folder_name IS NOT NULL AND
												  action = 's3_bucket_linked'
											GROUP BY node_id) s3
							ON osf_abstractnode.id = s3.node_id
							WHERE type = 'osf.node' AND 
								  is_deleted IS FALSE AND 
								  title NOT LIKE 'Bookmarks' 
								  AND (spam_status IS NULL OR spam_status = 4))

SELECT osf_abstractnode.id AS node_id, 
	   type, created, 
	   deleted_date, 
	   is_fork, 
	   is_deleted, 
	   is_public, 
	   registered_date, 
	   creator_id, 
	   embargo_id, 
	   registered_from_id, 
	   retraction_id, 
	   root_id, 
	   tag_id, 
	   preprint_id, 
	   preprint_created, 
	   supp_node,
	   num_files,
	   first_osf_file_created,
	   last_osf_file_created,
	   num_addons,
	   first_addon_added,
	   last_addon_added,
	   bitbucket_added,
	   box_added,
	   dataverse_added,
	   dropbox_added,
	   figshare_added,
	   github_added,
	   gitlab_added,
	   googledrive_added,
	   onedrive_added,
	   owncloud_added,
	   s3_added
	FROM osf_abstractnode
	
	LEFT JOIN (SELECT *
					FROM osf_abstractnode_tags
					WHERE tag_id = 26265) AS osf4m_tags
	ON osf_abstractnode.id = osf4m_tags.abstractnode_id
	
	LEFT JOIN (SELECT id AS preprint_id, created AS preprint_created, node_id AS supp_node
					FROM osf_preprint
					WHERE node_id IS NOT NULL) AS supp_nodes
	ON osf_abstractnode.id = supp_nodes.supp_node
	
	LEFT JOIN existing_files
	ON osf_abstractnode.id = existing_files.target_object_id

	LEFT JOIN addon_connections
	ON osf_abstractnode.id = addon_connections.id

	WHERE (type LIKE 'osf.node' OR type LIKE 'osf.registration') AND 
			title NOT LIKE 'Bookmarks' AND
			(spam_status IS NULL OR spam_status = 4) AND 
			is_deleted IS FALSE AND 
			retraction_id IS NULL AND
			osf_abstractnode.id NOT IN (94,163,376,429,480,690,722,892,902,1703,1785,1806,2113,2173,2219,2470,2483,2547,2636,2695,2739,2787,2863,2918,3151,3153,4562,4595,4804,4845,5045,5226,5263,5338,8019,8067,8310,8387,8424,8473,8632,8835,9038,9080,15586,15604,15609,15653,15933,16177,16284,17348,17377,18479,18685,18726,18936,18988,19137,19217,19312,19477,19539,19546,21650,21769,21983,22265,22343,22809,22852,22930,22936,23440,24145,24633,24725,24788,24994,25260,26726,27267,27807,27943,28155,28321,28526,28547,28637,28733,28835,29102,29119,29152,29778,29913,29982,30080,30394,30582,30587,30655,30887,31442,32567,33210,33238,33435,33686,33984,34078,34300,34415,34514,34650,34824,35072,35523,35525,35535,35653,35654,35700,35840,36303,36397,36638,36717,36776,37162,37979,38039,38411,38639,38939,39639,39687,39749,39910,39919,40000,40106,40207,40296,40333,40579,44585,45141,45459,45793,45880,45922,46120,46137,46293,48064,48111,48481,48506,48523,48525,48971,48974,49366,49380,49684,49806,50264,50555,50761,50900,50958,51173,51212,51395,51555,51595,51743,51779,51865,52118,52155,52198,52281,52438,52525,52619,53106,53321,53438,53610,53720,53760,53856,53914,54041,54119,54182,54260,54263,54525,54530,54609,54628,54789,54830,54941,54995,54997,55036,55080,55431,55601,55758,55810,56145,56457,56525,56577,56617,56688,56893,57682,57734,58116,58512,58819,58930,59039,59339,60194,60971,61023,61432,62200,62290,62626,62950,63063,63196,63648,63684,63736,64378,64588,64891,65093,65266,65320,65569,66316,67039,67944,68109,68647,69526,69758,69766,69783,70469,70477,70536,70755,70803,70848,70947,71013,71341,71392,71809,71824,72664,72707,73099,73348,73406,73867,74439,74525,74529,74769,74843,74941,75322,75809,76039,76152,76154,76331,76340,76423,76596,76646,76660,76703,76708,76912,76928,77045,77058,77091,77108,77336,77436,77481,77648,77776,78276,78328,78438,78504,79180,79568,79635,79755,80006,80338,80610,80696,80944,81212,81272,81361,82570,82788,82797,82887,83024,83089,83506,84059,84070,84084,84145,84406,84612,84812,84996,85043,85063,85084,85195,85347,85669,86477,86585,86674,86697,86736,86791,86885,87584,87667,87759,87939,87947,88040,89334,89771,90010,90427,90537,90627,90780,91033,91296,91422,91467,92334,92730,92815,92866,93032,93218,93248,93525,93841,94003,94044,94093,94148,94326,94548,94583,94691,94699,94714,94940,95049,95115,95439,95655,96109,96502,96543,96546,96568,96609,96646,96784,96940,97107,97133,97172,97203,97686,97789,98106,98295,98345,98450,98646,98696,98817,98829,98915,98940,99201,99305,99587,99966,100027,100066,100071,100426,100469,100512,100556,100713,100861,100935,101333,101639,101655,101770,101832,102020,102024,102093,102133,102300,102337,102402,102512,102527,102717,102730,102818,102842,102884,102892,102996,103018,103142,103143,103280,103387,103528,103624,103836,103960,104029,104161,104364,104622,104626,106150,107238,107435,109115,109244,109330,109949,110138,110367,110610,110998,111498,111720,111792,111795,112087,112110,112236,112301,112471,112590,112805,112870,112926,113119,113244,113255,113373,113469,113614,113813,113858,113867,113970,114071,114149,114170,114188,114249,114513,114707,114772,115057,115267,115313,115381,115593,115663,115711,116472,116572,116584,116665,117350,117797,117876,118264,118345,118611,118744,118786,118942,119048,119070,119362,119494,119587,119710,120530,120667,120930,121206,121624,121714,121753,121855,122562,122619,122706,123225,123418,123936,124764,125228,125235,125484,125661,125922,125990,126079,126263,126341,126490,126628,127002,127078,127255,127342,127424,127494,127828,127875,128026,128191,128738,128862,128986,129343,129405,129851,130177,130631,130703,130899,130954,131023,131048,131114,131340,131408,131459,131473,131505,131589,131647,131835,131946,132028,132063,132507,132758,132869,132887,132893,132900,132932,132960,133162,133446,133456,133532,133556,133611,133697,133743,133826,133868,134155,134159,134200,134243,134344,134355,135003,135081,135174,135203,135282,135436,136091,136576,136680,136769,136987,137164,137173,137549,137591,138168,138417,138445,138555,138726,138755,139317,139707,140115,140116,140218,140802,141984,142314,142340,143215,144422,144751,144995,145255,145354,145573,145839,145947,146019,146023,146162,146183,146305,146421,146501,146678,146724,146925,147097,147109,147333,147444,147469,147524,147545,147685,147995,148221,148497,148607,148613,148838,148840,148944,149252,149816,150180,150336,150411,150413,150445,150491,150771,150827,151223,151816,151822,152219,152316,152370,152441,152462,152498,152586,152685,152920,153011,153073,153173,153222,153626,153926,154172,155292,155309,155802,155860,156347,157291,157450,157477,158038,158061,158091,158513,159058,159094,159097,159114,159421,160213,160650,160666,160758,160790,160795,160875,160942,161174,161182,161215,161267,161338,161401,161421,161584,161589,161747,161768,161783,161822,162475,162770,162912,162936,162939,163012,163293,163418,163495,163530,164260,164387,164419,164436,164497,164583,164724,164828,164881,164989,165109,165202,165649,165792,165798,165804,165983,166126,166161,166235,166453,166470,166514,166928,167275,167326,167381,167558,167632,167841,168026,168348,168655,168860,168926,168937,168938,169204,169420,169460,169790,169862,169933,170069,170274,170325,170383,170458,170640,170682,170812,170880,170969,171055,171102,171267,171597,171600,171608,171673,171739,172113,172200,172240,172385,172505,172684,172740,172885,172913,173275,173300,173476,173615,173777,174335,174529,174577,174910,174932,174960,175020,175155,175416,175449,176515,176717,177385,177610,178031,178487,178603,178636,178711,178768,178889,178894,179021,179074,179169,179271,179377,179378,179382,179402,179473,179621,179693,179894,180092,180169,180197,180281,180792,181315,182883,182920,183036,183044,183294,183301,183465,183650,183705,183823,183943,184090,184204,184362,184458,184505,184701,184823,184907,185131,185197,185286,185328,185379,185383,185580,185694,185710,185799,185921,186216,186496,186641,186954,187063,187086,187232,187254,187339,187356,187494,187680,187962,188106,188351,188503,188561,188605,188882,188926,189377,189738,189962,190186,190274,190280,190515,190527,190705,191027,191117,191180,191342,191478,191540,191584,191682,191954,192189,192318,192359,192384,192539,192830,192877,192928,193152,193193,193667,193688,193728,193809,193974,193984,194373,194590,194656,194756,194851,194874,194891,195029,195086,195155,195202,195211,195316,195694,195804,195991,196180,196402,196421,196435,196530,196560,196590,196749,196798,196799,196866,196887,196964,197020,197242,197243,197564,197613,197644,197902,198089,198195,198315,198343,198347,198397,198445,198492,198606,198720,199092,199261,199296,199301,199469,199493,199523,199548,199597,199626,199725,199757,199774,199942,200278,200980,201133,201226,201247,201416,201548,201833,201836,201896,202183,202440,202631,202692,202939,203264,203310,203379,203610,203700,203741,203801,203895,204039,204126,204474,204624,204903,204907,204915,205190,205292,205384,205447,205666,205737,205743,206002,206088,206126,206217,206230,206263,206264,206281,206358,206361,206373,206390,206506,206613,206658,206829,207304,207331,207434,207519,207616,207642,207690,207915,207964,208060,208202,208297,208380,208406,208528,208544,208713,208742,208748,209087,209173,209307,209365,209452,209815,209903,209910,209919,209928,209974,209978,210029,210039,210247,210291,210544,210547,210694,211032,211057,211062,211304,211352,211445,211603,211798,211834,211905,212253,212327,212388,212901,212988,213012,213107,213434,213436,213463,213558,213567,213680,213686,214003,214108,214304,214537,214874,214875,214974,215134,215218,215320,215330,215435,215963,215999,216178,216219,216477,216551,216655,216823,216885,216907,217316,217342,217457,217492,217741,217805,217949,217986,218025,218168,218419,218456,218470,218807,219059,219097,219432,219700,219712,219893,219954,220183,220305,220465,220506,220582,220714,220851,220882,221295,221555,221611,221769,222072,222087,222349,222372,222497,222677,222931,223019,223033,223099,223152,223250,223852,223911,223980,224012,224074,224076,224077,224102,224105,224179,224281,224302,224385,224510,224625,224649,224703,224815,224859,225124,225623,225675,225714,225778,226146,226366,226370,226401,226449,226597,226604,226788,226929,226978,227017,227053,227191,227193,227316,227328,227733,227797,228138,228199,228337,228465,228513,228562,228632,228668,228765,228845,228865,228873,229053,229080,229097,229753,229760,230301,230310,230340,230419,230479,230938,231015,231249,231369,231568,254010,254036,254141,254242,254256,254267,254276,254332,254442,254462,254528,254688,254747,254787,254826,254899,254914,255112,255117,255163,255195,255243,255251,255254,255256,255259,255262,255266,255268,255270,255275,255278,255282,255285,255288,255290,255293,255295,255297,255300,255306,255309,255310,255312,255315,255316,255555,255562,255592,255689,255836,256040,256094,256108,256304,256305,256306,256307,256308,256309,256338,256387,256430,256508,256511,256526,256551,256594,256730,256825,256836,256847,256848,256851,256852,256905,257253,257329,257337,257735,257925,257960,257966,257971,258030,258038,258267,258446,258553,258579,258593,258656,258662,258667,258680,258809,258826,258851,258969,259017,259018,259033,259045,259078,259182,259385,259398,259434,259435,259452,259464,259548,259555,259591,259593,259594,259600,259601,259602,259605,259607,259608,259610,259625,259628,259677,259835,259841,260409,260433,260440,260472,260548,260564,260648,260746,260751,260818,260824,260849,260974,261005,261043,261191,261310,261353,261848,261849,261962,261991,262141,262143,262210,262338,262400,262416,262455,262457,262458,262459,262461,262463,262464,262465,262466,262467,262562,262599,262602,262625,262643,262689,262824,262897,262904,263027,263028,263051,263081,263082,263085,263088,263090,263092,263155,263181,263206,263223,263386,263389,263428,263435,263447,263448,263490,263496,263544,263547,263549,263584,263696,263708,263729,263811,263894,264049,264056,264059,264062,264068,264178,264192,264243,264277,264464,264474,264488,264510,264720,264722,264787,264795,264852,264865,264883,264917,264929,264987,264994,264997,265019,265041,265090,265128,265165,265233,265234,265239,265326,265415,265435,265508,265552,265623,265725,265748,265838,265850,265855,265954,265993,266012,266013,266066,266104,266114,266125,266140,266142,266196,266216,266241,266242,266271,266286,266306,266315,266328,266330,266334,266337,266348,266351,266375,266376,266383,266389,266423,266457,266539,266541,266543,266544,266545,266595,266837,266848,266854,266862,266866,266872,266877,266891,266895,266896,266898,266900,266901,266908,266913,266922,266923,266926,266927,266931,266949,266951,266962,266967,266968,266973,266976,266977,266984,266985,266988,266990,266991,266992,266994,267012,267084,267140,267153,267342,267413,267417,267423,267492,267494,267572,267593,267594,267595,267685,267686,267754,267769,267771,267839,267865,267867,267869,268018,268019,268039,268041,268112,268167,268199,268209,268215,268240,268273,268275,268338,268434,268469,268488,268506,268556,268580,268726,268742,268746,268747,268748,268750,268752,268753,268754,268805,268833,268834,268835,268836,268856,268876,268877,268880,268938,268951,268958,268966,268968,268971,268973,268981,268990,269003,269005,269006,269007,269009,269010,269012,269014,269028,269031,269033,269071,269072,269073,269075,269078,269081,269083,269086,269088,269089,269091,269092,269093,269096,269097,269098,269099,269101,269136,269165,269170,269173,269174,269175,269176,269177,269178,269179,269180,269181,269182,269184,269195,269197,269199,269200,269201,269202,269203,269204,269206,269207,269208,269216,269373,269375,269409,269412,269423,269446,269452,269456,269457,269460,269461,269462,269464,269466,269468,269470,269471,269475,269525,269536,269541,269550,269571,269600,269705,269812,269827,269829,269833,269834,269836,269847,269849,269957,269968,269986,269987,269990,269998,269999,270000,270024,270062,270087,270128,270156,270157,270173,270236,270239,270249,270252,270254,270257,270261,270266,270268,270269,270271,270338,270430,270450,270461,270501,270505,270581,270608,270619,270625,270635,270637,270647,270658,270665,270805,270895,270896,270912,271081,271112,271113,271115,271116,271117,271118,271247,271293,271314,271334,271345,271347,271362,271370,271371,271377,271435,271546,271618,271669,271754,271802,271821,271879,271882,271883,271923,271931,271933,272134,272152,272165,272174,272187,272193,272236,272264,272285,272387,272688,272882,272987,273029,273034,273064,273480,273490,273518,273528,273531,273566,273676,273792,273801,273805,273833,273877,273965,274087,274101,274105,274126,274142,274160,274282,274284,274314,274459,274460,274465,274478,274503,274508,274551,274569,274619,274651,274654,274669,274691,274722,274755,274764,274778,274779,274836,274890,274895,274896,274897,274909,274925,274993,275061,275150,275154,275161,275218,275219,275557,275863,275878,275889,275897,275900,276037,276090,276103,276105,276107,276108,276109,276110,276111,276112,276178,276269,276274,276282,276283,276310,276311,276314,276316,276317,276319,276320,276321,276323,276325,276328,276329,276333,276336,276340,276372,276411,276442,276455,276459,276531,276543,276547,276587,276591,276594,276596,276597,276602,276603,276604,276605,276608,276627,276642,276645,276652,276672,276691,276850,276862,276870,276873,276878,276883,276887,276893,276899,276912,276968,276991,277011,277057,277196,277200,277214,277282,277367,277377,277395,277398,277424,277427,277428,277430,277437,277447,277468,277587,277738,277760,277830,277839,277882,277998,278019,278135,278267,278293,278345,278346,278386,278535,278597,278622,278627,278629,278635,278765,278772,278777,278780,278781,278783,278787,278805,278807,278809,278815,278817,278825,278909,278914,279001,279016,279017,279029,279034,279256,279279,279280,279358,279362,279364,279366,279377,279384,279469,279533,279732,279735,279737,279762,279777,279852,283169,290516,290561,290613,290623,290681,290717,290792,290802,290924,290926,290927,290930,290931,291051,291057,294712,294740,294742,294794,294801,294822,294848,294849,294853,294855,294860,294918,294920,294928,295114,295175,295205,295276,295322,295345,295479,295665,295667,295686,295692,295695,295956,295958,295959,295960,295961,296062,296103,296109,296144,296257,296375,296456,296459,296550,296657,296661,296662,296668,296685,296689,296874,296878,296888,296896,296923,296943,296981,296997,297170,297184,297229,297242,297252,297332,297358,297400,297460,297524,297671,297684,297722,297723,297795,297811,297851,297869,297907,297947,298084,298148,298218,298264,298269,298272,298318,298338,298374,298381,298409,298424,298436,298536,298565,298576,298599,298602,298628,298812,298882,298885,298888,298915,298942,299061,299078,299080,299081,299118,299123,299127,299130,299133,299134,299169,299239,299296,299308,299309,299318,299326,299327,299390,299671,299718,299724,299725,299735,299782,299803,299805,299852,299964,299969,299989,300009,300010,300027,300040,300187,300188,300189,300233,300238,300240,300242,300323,300324,300358,300390,300436,300594,300724,300727,300924,300939,300982,300987,300991,301076,301139,301158,301178,301278,301294,301300,301302,301304,301306,301322,301327,301375,301491,301647,301657,301673,301704,301717,301725,301738,301795,301915,301917,301931,301934,301968,301978,302041,302043,302053,302067,302182,302203,302342,302939,302940,302941,302942,302943,302949,302951,303004,303005,303222,303224,303226,303227,303229,303236,303286,303306,303323,303387,303447,303449,303450,303451,303659,303781,303817,303960,303998,304028,304176,304181,304189,304193,304195,304197,304199,304200,304308,304323,304348,304355,304370,304378,304424,304445,304468,304474,304476,304480,304502,304511,304547,304549,304577,304693,304809,304814,304816,304852,304863,304865,304889,304922,304923,304924,304946,304969,304973,304999,305049,305102,305105,305151,305168,305173,305235,305334,305335,305344,305347,305348,305349,305351,305375,305395,305397,305548,305577,305580,305613,305644,305663,305732,305825,305827,305858,305992,306119,306130,306137,306140,306141,306213,306301,306325,306372,306379,306397,306411,306673,306674,306676,306677,306679,306680,306682,306683,306700,306701,306755,306760,306783,306824,307182,307238,307316,307341,307342,307344,307378,307504,307572,307573,307579,307634,307710,307724,307735,307760,307869,307961,307963,307978,307982,307983,308116,308248,308361,308368,308393,308495,308558,308560,308567,308608,308609,308610,308611,308648,308734,308765,308778,308782,308842,308993,309070,309074,309075,309133,309334,309446,309536,309576,309669,309759,309767,309768,309827,309902,309911,309922,309926,309934,310142,310154,310190,310375,310401,310421,310440,310504,310574,310590,310731,310740,310742,310759,310808,310814,310819,310820,310821,310822,310823,310904,310937,310959,310967,310968,310969,310970,310971,310974,310975,310976,311009,311018,311022,311023,311025,311028,311130,311244,311273,311462,311477,311540,311732,311734,311821,311948,311949,313352,313992,314260,314265,314389,314424,314448,314490,314516,314517,314519,314531,314549,314560,314577,314607,314626,314627,314659,314678,314697,314710,314761,314822,314825,314849,314914,314959,315058,315078,315079,315084,315087,315090,315120,315124,315127,315134,315138,315154,315155,315161,315172,315181,315187,315332,315522,315531,315536,315540,315542,315548,315552,315554,315560,315579,315580,315581,315582,315583,315584,315585,315586,315587,315589,315640,315642,315646,315649,315650,315653,315657,315659,315660,315662,315664,315667,315670,315673,315676,315679,315682,315684,315686,315688,315690,315695,315697,315728,315739,315876,316055,316112,316116,316196,316253,316265,316318,316319,316321,316324,316326,316327,316332,316333,316335,316343,316345,316355,316356,316363,316383,316384,316386,316437,316441,316444,316445,316447,316448,316456,316474,316476,316477,316485,316489,316546,316567,316571,316582,316591,316669,316686,316750,316790,316841,316843,317614,317736,317742,317750,317763,317776,317785,317786,317788,317823,317859,318042,318182,318190,318212,318228,318278,318298,318351,318361,318362,318416,318425,318426,318432,318453,318499,318520,318541,318544,318551,318570,318592,318595,318658,318663,318669,318672,318743,318781,319086,319088,319163,319222,319292,319335,319338,319342,319363,319409,319431,319538,319545,319552,319615,319616,319935,319949,319984,320283,320284,320297,320309,320351,320419,320431,320462,320504,320515,320524,320572,320583,320790,320900,320963,321032,321035,321173,321295,321301,321318,321319,321327,321354,321355,321384,321466,321529,321531,321536,321541,321545,321550,321552,321554,321574,321575,321576,321577,321578,321580,321586,321608,321617,321637,321758,321759,321772,321775,321790,321798,321853,321855,321869,321909,321912,321914,321920,321957,321969,322067,322070,322073,322076,322220,322227,322229,322296,322380,322455,322462,322476,322507,322511,322514,322533,322547,322581,322675,322680,322682,322689,322691,322794,322804,322892,322944,322945,322966,323064,323065,323175,323179,323186,323226,323227,323229,323232,323250,323265,323267,323298,323299,323432,323470,323523,323657,325805,326200,326219,326333,326335,326349,326350,326365,326376,326461,326468,326489,326493,326511,326578,326622,326660,326669,326676,326706,326714,326721,326725,326866,326895,326906,326938,326975,326980,326995,327019,327154,327223,327227,327229,327252,327257,327260,327267,327328,327350,327356,327358,327360,327378,327380,327441,327472,327475,327531,327535,327565,327579,327617,327629,327632,327696,327703,327865,327870,327883,327909,327911,327959,328052,328127,328136,328163,328352,328381,328401,328571,328613,328656,328695,328721,328759,328784,329200,329749,329767,329798,329799,329821,329846,329881,329895,329947,329958,329960,329967,329973,329999,330005,330017,330020,330036,330077,330104,330128,330137,330176,330187,330194,330206,330208,330218,330228,330246,330247,330254,330261,330292,330313,330328,330332,330352,330384,330387,330399,330440,330461,330464,330465,330517,330605,330609,330633,330701,330705,330726,330821,330822,330826,330856,330864,330869,330906,330919,330922,330923,330943,330945,330979,330981,330987,330990,330993,331020,331089,331092,331158,331207,331211,331217,331227,331239,331262,331267,331290,331295,331301,331311,331313,331315,331322,331323,331326,331367,331382,331395,331420,331423,331424,331438,331463,331468,331471,331494,331498,331517,331541,331542,331550,331566,331571,331572,331576,331580,331582,331585,331587,331589,331590,331606,331608,331652,331673,331676,331785,331786,331809,331824,331844,331845,331848,331849,331881,331908,331910,332025,332027,332035,332036,332037,332042,332088,332092,332116,332128,332129,332164,332196,332215,332217,332226,332313,332314,332351,332362,332379,332389,332413,332475,332481,332493,332523,332532,332541,332542,332568,332580,332591,332604,332611,332614,332616,332620,332626,332637,332638,332643,332653,332659,332667,332700,332729,332754,332761,332781,332786,332807,332815,332837,332840,332842,332843,332854,332863,332872,332894,332908,332917,332947,332957,332982,332995,332996,333018,333028,333104,333105,333140,333173,333175,333197,333200,333203,333205,333206,333208,333209,333211,333229,333274,333359,333372,333393,333398,333409,333508,333513,333524,333541,333542,333551,333591,333595,333596,333598,333599,333601,333605,333607,333608,333609,333611,333613,333614,333616,333620,333630,333637,333645,333648,333664,333670,333675,333684,333688,333689,333727,333728,333765,333776,333870,333914,333924,333945,333991,334012,334047,334049,334052,334057,334058,334059,334060,334061,334069,334076,334083,334084,334090,334093,334123,334126,334138,334141,334155,334156,334179,334228,334230,334243,334251,334252,334263,334268,334272,334280,334286,334300,334301,334303,334305,334342,334344,334345,334346,334355,334359,334398,334408,334414,334452,334474,334496,334508,334510,334520,334521,334523,334524,334528,334532,334534,334537,334540,334543,334547,334550,334602,334645,334648,334653,334656,334657,334668,334672,334673,334676,334695,334741,334753,334767,334900,334903,334912,334919,334952,334953,334954,334956,334986,334993,334999,335000,335001,335002,335004,335020,335025,335102,335112,335169,335186,335191,335194,335199,335201,335204,335206,335211,335222,335235,335243,335247,335267,335299,335303,335306,335315,335333,335346,335366,335370,335377,335402,335407,335410,335413,335452,335463,335465,335522,335564,335627,335664,335670,335697,335701,335726,335728,335731,335748,335751,335763,335773,335774,335776,335777,335797,335799,335803,335804,335806,335815,335833,335867,335884,335903,335916,335941,335945,335947,335953,335969,335972,335976,336024,336048,336049,336057,336067,336078,336085,336089,336104,336109,336120,336130,336141,336147,336151,336168,336208,336225,336226,336230,336232,336234,336241,336245,336252,336257,336292,336297,336329,336360,336361,336364,336374,336407,336410,336413,336437,336438,336440,336442,336444,336449,336476,336496,336557,336560,336568,336587,336603,336634,336640,336674,336675,336676,336680,336736,336778,336841,336889,336899,337004,337033,337048,337049,337050,337121,337126,337133,337140,337143,337148,337149,337160,337167,337184,337189,337190,337191,337196,337197,337199,337204,337246,337289,337322,337356,337357,337358,337366,337391,337418,337513,337562,337570,337571,337591,337626,337630,337651,337653,337681,337691,337692,337693,337715,337717,337719,337721,337722,337746,337761,337763,337774,337779,337798,337802,337931,337963,337975,337978,338043,338114,338126,338127,338128,338129,338162,338176,338263,338270,338276,338328,338332,338334,338336,338339,338342,338354,338356,338358,338361,338363,338366,338368,338371,338374,338394,339306,339308,339311,339313,339352,339435,339440,339459,339475,339504,339511,339517,339520,339522,339523,339538,339540,339545,339546,339547,339548,339550,339551,339557,339573,339578,339586,339593,339601,339602,339627,339635,339652,339662,339749,339757,339761,339848,339914,340011,340014,340017,340020,340030,340046,340051,340052,340056,340058,340063,340073,340076,340081,340082,340085,340086,340092,340094,340100,340102,340152,340163,340172,340211,340271,340283,340374,340391,340420,340424,340428,340568,340570,340578,340601,340632,340634,340660,340726,340732,340737,340760,340781,340806,340819,340836,340839,340880,340903,340945,341955,341969,342415,347924,347936,347964,347966,347968,347978,347984,347995,348020,348064,348114,348150,348157,348185,348250,348254,348265,348268,348312,348320,348415,348425,348512,348525,348529,348530,348538,348539,348566,348568,348602,348607,348631,348672,348727,348728,348769,348778,348785,348809,348880,348889,348932,348946,348961,348965,348969,348988,348993,349056,349111,349127,349190,349202,349217,349221,349241,349242,349281,349313,349417,349419,349446,349455,349478,349520,349528,349534,349569,349700,349711,349712,349725,349733,349762,349783,349786,349791,349832,349837,349848,349854,349886,349914,349925,349938,349955,349975,350081,350094,350113,350114,350118,350136,350248,350249,350254,350257,350271,350276,350293,350343,350364,350395,350405,350411,350417,350494,350504,350509,350520,350523,350531,350550,350555,350564,350569,350571,350602,350611,350612,350614,350615,350616,350617,350618,350674,350735,350761,350796,350853,350861,350876,350877,350881,350886,350891,350896,350899,350905,350911,350916,350921,350924,350935,350941,350943,350945,350946,350949,350951,350953,350957,350972,350975,350976,350981,350983,350986,351032,351056,351057,351080,351083,351104,351133,351150,351179,351199,351204,351210,351278,351300,351313,351460,351490,351515,351588,351597,351618,351626,351627,351731,351780,351782,351784,351785,351786,351788,351790,351792,351793,351794,351807,351810,351860,351864,351867,351870,351874,351907,352077,352094,352108,352117,352139,352255,352326,352344,352357,352372,352377,352379,352389,352401,352419,352456,352517,352542,352677,352701,352721,352727,352733,352734,352735,352740,352826,352836,352967,353013,353026,353109,353131,353134,353147,353205,353236,353253,353256,353258,353260,353268,353275,353276,353281,353406,353461,353463,353500,353518,353521,353532,353559,353610,353628,353688,353695,353822,353861,353898,353906,353927,353954,353988,354001,354015,354027,354037,354058,354059,354073,354079,354091,354105,354109,354121,354141,354179,354193,354220,354299,354338,354341,354357,354368,354401,354415,354418,354422,354433,354440,354446,354452,354564,354567,354618,354641,354714,354719,354725,354750,354753,354800,354820,354916,354918,354936,354946,354957,355018,355035,355037,355072,355090,355092,355096,355097,355101,355107,355111,355141,355145,355158,355159,355164,355170,355181,355195,355196,355218,355254,355285,355294,355354,355427,355563,355578,355614,355616,355637,355648,355718,355868,355873,355886,355901,355932,355934,355938,355946,355948,355950,355951,355952,355953,356005,356006,356014,356015,356030,356047,356054,356055,356057,356058,356066,356070,356071,356072,356104,356106,356110,356116,356119,356120,356129,356217,356250,356260,356262,356280,356285,356292,356309,356318,356320,356325,356329,356331,356339,356342,356345,356432,356540,356549,356636,356664,356687,356688,356689,356690,356691,356692,356696,356697,356698,356700,356701,356702,356703,356743,356745,356746,356749,356750,356751,356752,356753,356755,356756,356757,356758,356760,356761,356762,356764,356765,356767,356770,356771,356772,356776,356777,356778,356780,356782,356783,356784,356785,356786,356804,356858,356860,357021,357032,357068,357087,357088,357089,357123,357385,357386,357387,357389,357407,357420,357443,357530,357556,357608,357610,357611,357612,357614,357617,357619,357620,357621,357622,357623,357624,357626,357628,357629,357631,357634,357638,357639,357641,357642,357653,357654,357655,357656,357657,357660,357661,357662,357663,357669,357671,357676,357680,357681,357682,357683,357685,357686,357689,357691,357692,357707,357712,357716,357720,357732,357733,357738,357740,357745,357772,357779,357783,357788,357792,357801,357817,357824,357893,358055,358113,358118,358130,358145,358146,358157,358165,358167,358172,358176,358180,358182,358317,358714,358916,359624,359903,360224,360240,360526,360720,360831,360836,360840,360841,360846,360848,360856,360865,360876,360883,360894,360897,360926,360942,360958,360981,360986,360994,361025,361082,361201,361208,361286,361296,361298,361325,361327,361328,361336,361337,361347,361363,361365,361372,361382,361388,361391,361405,361429,361431,361436,361437,361438,361441,361445,361451,361453,361480,361481,361497,361516,361521,361522,361525,361566,361632,361643,361744,361750,361762,361806,361809,361814,361816,361838,361862,361998,362026,362037,362038,362046,362047,362050,362051,362053,362055,362136,362158,362299,362302,362312,362357,362378,362421,362450,362470,362539,362558,362561,362563,362565,362567,362587,362630,362631,362639,362712,362725,362754,362766,362778,362808,362825,362848,362998,363105,363154,363219,363228,363233,363235,363255,363256,363258,363275,363302,363317,363327,363336,363359,363398,363438,363479,363642,363656,363686,363793,363796,364039,364102,364103,364110,364121,364167,364174,364175,364180,364229,364231,364233,364237,364244,364246,364249,364253,364256,364261,364263,364274,364277,364286,364290,364291,364292,364295,364299,364301,364393,364413,364414,364433,364435,364436,364438,364439,364465,364466,364467,364469,364471,364472,364473,364491,364493,364551,364591,364604,364621,364622,364637,364639,364642,451382,451404,451405,451412,451418,451423,451426,451429,451432,451433,451434,451435,451440,451449,451450,451454,451490,451518,451527,451579,451589,451590,451595,451619,451625,451653,451671,451677,451679,451718,451725,451757,451787,451790,451803,451808,451822,452035,452045,452052,452058,452065,452067,452073,452096,452215,452219,452220,452221,452224,452227,452245,452467,452474,452483,452489,452497,452522,452540,452561,452577,452578,452579,452582,452583,452650,452651,452652,452653,452676,452684,452714,452959,453115,453121,453238,453323,453332,453360,453781,453832,453895,454048,454337,454495,454496,454549,454569,454699,454832,454934,454957,455001,455084,455173,455174,455411,455428,455477,455615,455617,455627,455711,455713,455735,455757,455759,455762,455767,455776,455777,455779,455823,455834,455838,455976,456187,456202,456236,456271,456275,456352,456473,456539,456541,456557,456597,456598,456599,456600,456603,456604,456605,456609,456610,456661,456662,456679,456680,456694,456697,456698,456703,456713,456714,456715,456745,456749,456754,456784,456812,456843,456844,456845,456848,456868,456936,456940,456964,457023,457042,457053,457086,457135,457196,457256,457267,457271,457272,457299,457335,457336,457337,457355,457363,457388,457461,457484,457522,457529,457540,457601,457611,457640,457645,457677,457745,457748,457755,457887,457891,457899,457904,457905,457913,457986,457989,458043,458049,458109,458112,458119,458149,458154,458158,458215,458226,458280,458281,458297,458320,458373,458382,458405,458423,458449,458463,458467,458501,458555,458765,458784,458821,458842,458910,458955,458995,458998,458999,459006,459007,459013,459018,459021,459035,459045,459061,459090,459122,459174,459202,459243,459277,459298,459380,459384,459501,459625,459660,459682,459686,459688,459814,459817,459859,459988,459991,460063,460067,460071,460092,460112,460119,460143,460186,460194,460205,460245,460262,460281,460288,460292,460298,460308,460317,460330,460359,460366,460378,460581,460590,460600,460603,460703,460707,460724,460765,460912,460917,460920,460921,460928,460947,460954,460967,460986,460999,461000,461007,461020,461074,461109,461121,461139,461161,461190,461234,461249,461251,461258,461277,461294,461301,461365,461632,461639,461665,461702,461703,461734,461768,461769,461777,461778,461782,461795,461814,461828,461829,461839,461844,461847,461850,461985,461990,461992,462079,462105,462109,462143,462146,462177,462178,462187,462305,462364,462379,462396,462399,462404,462405,462414,462419,462420,462429,462434,462443,462458,462462,462465,462470,462473,462476,462479,462493,462500,462507,462518,462521,462524,462527,462530,462541,462562,462572,462576,462579,462584,462590,462591,462603,462624,462627,462768,462892,462900,463156,463180,463182,463193,463228,463244,463261,463319,463322,463329,463340,463354,463365,463366,463399,463422,463441,463444,463449,463452,463461,463464,463514,463519,463567,463583,463623,463762,463777,463787,463835,463894,463903,463930,463936,463945,463954,464005,464064,464098,464197,464204,464222,464275,464281,464293,464294,464302,464325,464648,464651,464689,464691,464724,464763,464809,464810,464853,464858,464859,464860,464874,464877,464898,464911,464947,465102,465104,465237,465284,465322,465378,465392,465487,465490,465491,465494,465495,465499,465505,465506,465542,465546,465552,465553,465574,465624,465631,465684,465709,465799,465884,465909,465993,465997,466050,466061,466092,466095,466106,466217,466679,466680,466705,466715,466718,466775,466776,466781,466812,466827,466858,466889,466903,466904,466910,466915,466925,466944); 